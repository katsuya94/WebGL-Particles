<html>
<head>
	<script id="draw-vs" type="x-shader/x-fragment">

attribute vec3 a_position;

uniform mat4 u_mvp;

void main() {
	gl_Position = u_mvp * vec4(a_position, 1.0);
	gl_PointSize = 5.0;
}

	</script>
	<script id="draw-fs" type="x-shader/x-vertex">

void main() {
	gl_FragColor = vec4(1.0, 1.0, 1.0, 1.0);	
}

	</script>
	<script id="phys-vs" type="x-shader/x-fragment">

void main() {
	
}

	</script>
	<script id="phys-fs" type="x-shader/x-vertex">

precision mediump float;

uniform float u_dt;

void main() {
	int slot = int(mod(gl_FragCoord.x, 2.0));
}

	</script>

	<script>

// Creates and compiles a shader from source
function createShader( source, type ) {

	var shader = gl.createShader( type );

	gl.shaderSource( shader, source );
	gl.compileShader( shader );

	if ( !gl.getShaderParameter( shader, gl.COMPILE_STATUS ) )
		throw gl.getShaderInfoLog( shader );

	return shader;
}

// Creates a shader program and creates / links shaders
function createProgram( vertexSource, fragmentSource ) {

	var vs = createShader( vertexSource, gl.VERTEX_SHADER );
	var fs = createShader( fragmentSource, gl.FRAGMENT_SHADER );

	var program = gl.createProgram();

	gl.attachShader( program, vs );
	gl.attachShader( program, fs );
	gl.linkProgram( program );

	if ( !gl.getProgramParameter( program, gl.LINK_STATUS ) )
		throw gl.getProgramInfoLog( program );

	return program;
}


function main() {
	var canvas = document.getElementById('webgl');
	gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
	gl.clearColor(0.0, 0.0, 0.0, 1.0);
	gl.enable(gl.DEPTH_TEST);

	var program_draw = createProgram(
		document.getElementById('draw-vs').text,
		document.getElementById('draw-fs').text);
	var program_phys = createProgram(
		document.getElementById('phys-vs').text,
		document.getElementById('phys-fs').text);

	// Uniforms
	var u_dt = gl.getUniformLocation(program_phys, 'u_dt'); // The time step between frames (for physics calculation)

	// Make a rectangle that draws over the whole state
	var state_rect = gl.createBuffer();
	gl.bindBuffer(gl.ARRAY_BUFFER, state_rect);
	gl.bufferData(gl.ARRAY_BUFFER, new Float32Array([
		-1.0, -1.0,
		 1.0, -1.0,
		-1.0,  1.0,
		 1.0,  1.0
	]), gl.STATIC_DRAW);

	// Make a buffer for use as a framebuffer that stores the state

	gl.uniform1f(u_dt, 50.0);

	gl.useProgram(program_draw);

	gl.clear(gl.DEPTH_BUFFER_BIT | gl.COLOR_BUFFER_BIT);

	// The key gl.frameBufferTexture()
}

	</script>
</head>
<body onload="main()">
	<canvas id="webgl" style="width: 800px; height: 600px;">
	</canvas>
</body>
</html>
		
		
